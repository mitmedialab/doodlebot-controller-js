/*
Copyright (c) Daybrush
name: croact
license: MIT
author: Daybrush
repository: git+https://github.com/daybrush/croact.git
version: 1.0.0
*/
!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n((t="undefined"!=typeof globalThis?globalThis:t||self).Croact={})}(this,(function(t){"use strict";var n="function",e="string",r="number",o="undefined";function i(t){return typeof t===e}function u(t){return typeof t===r}function c(t){return typeof t===n}function f(t,n){return void 0===n&&(n="-"),t.replace(/([a-z])([A-Z])/g,(function(t,e,r){return""+e+n+r.toLowerCase()}))}function s(t){return Object.keys(t)}function a(t){return s(t).map((function(n){return[n,t[n]]}))}function p(t,n,e,r){t.removeEventListener(n,e,r)}var d=function(t,n){return d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])},d(t,n)};function l(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}d(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}var v=function(){return v=Object.assign||function(t){for(var n,e=1,r=arguments.length;e<r;e++)for(var o in n=arguments[e])Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o]);return t},v.apply(this,arguments)};function h(t,n){var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&n.indexOf(r)<0&&(e[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(t);o<r.length;o++)n.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(e[r[o]]=t[r[o]])}return e}function _(t,n,e){if(e||2===arguments.length)for(var r,o=0,i=n.length;o<i;o++)!r&&o in n||(r||(r=Array.prototype.slice.call(n,0,o)),r[o]=n[o]);return t.concat(r||Array.prototype.slice.call(n))}function y(t){var n=0;return t.map((function(t){return null==t?"$compat".concat(++n):"".concat(t)}))}function m(t){var n=[];return t.forEach((function(t){var e;n=n.concat((e=t,Array.isArray(e)?m(t):t))})),n}function g(t,n){if(!n)return t;for(var e in n)typeof t[e]===o&&(t[e]=n[e]);return t}function b(t,n){if(t===n)return!1;for(var e in t)if(!(e in n))return!0;for(var e in n)if(t[e]!==n[e])return!0;return!1}function $(t){var n=t.className,e=h(t,["className"]);return null!=n&&(e.class=n),delete e.style,delete e.children,e}function x(t){var n={},e={};for(var r in t)0===r.indexOf("on")?e[r]=t[r]:n[r]=t[r];return[n,e]}function O(t){if(!t)return null;var n=t.b;return n instanceof Node?n:O(t.c)}function E(t){var n=t.parentNode;n&&n.removeChild(t)}function w(t){t.forEach((function(t){t()}))}function C(){return this.constructor(this.props,this.context)}var P=0,j=null,T=function(){function t(t,n,e,r,o,i,u){void 0===u&&(u={}),this.t=t,this.d=n,this.k=e,this.i=r,this.c=o,this.ref=i,this.ps=u,this.typ="prov",this._ps=[],this._cs={},this._hyd=null,this._sel=!1}return t.prototype.s=function(){return!0},t.prototype.u=function(t,n,e,r,o){var u,c,f,a,p=this,d=p.d,l=m((u=n,s(u).map((function(t){return u[t]}))).filter((function(t){return t.$_req})).map((function(t){return t.$_subs}))),v=(a=function(t,n,e){void 0===e&&(e=-1);for(var r=t.length,o=0;o<r;++o)if(n(t[o],o,t))return o;return e}(c=l,(function(t){return t.d===d})),a>-1?c[a]:f);if(p.b&&!i(e)&&!o&&!p.s(e.props,r)&&!v)return l.reduce((function(t,n){var e=n.d;return t[0]?t[0].d===e&&t.push(n):e>d&&t.push(n),t}),[]).forEach((function(e){X(e,e._ps,[e.o],t,n,!0)})),!1;p.o=e,p.ss(r);var h=p.ps;return i(e)||(p.ps=e.props,p.ref=e.ref),N(this),p.r(t,n,p.b?h:{},r),!0},t.prototype.md=function(){this.rr()},t.prototype.ss=function(){},t.prototype.ud=function(){this.rr()},t.prototype.rr=function(){var t=this,n=t.ref,e=t.fr;n&&n(e?e.current:t.b)},t}();function S(){return j}function A(){return P}function N(t){j=t,P=0}var U=function(){function t(t,n){void 0===t&&(t={}),this.props=t,this.context=n,this.state={},this.$_timer=0,this.$_state={},this.$_subs=[],this.$_cs={}}return t.prototype.render=function(){return null},t.prototype.shouldComponentUpdate=function(t,n){return this.props!==t||this.state!==n},t.prototype.setState=function(t,n,e){var r=this;r.$_timer||(r.$_state={}),clearTimeout(r.$_timer),r.$_timer=0,r.$_state=v(v({},r.$_state),t),e?r.$_setState(n,e):r.$_timer=window.setTimeout((function(){r.$_timer=0,r.$_setState(n,e)}))},t.prototype.forceUpdate=function(t){this.setState({},t,!0)},t.prototype.componentDidMount=function(){},t.prototype.componentDidUpdate=function(t,n){},t.prototype.componentWillUnmount=function(){},t.prototype.$_setState=function(t,n){var e=[],r=this.$_p;X(r.c,[r],[r.o],e,r._cs,v(v({},this.state),this.$_state),n)&&(t&&e.push(t),w(e),N(null))},t}(),k=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return l(n,t),n.prototype.shouldComponentUpdate=function(t,n){return b(this.props,t)||b(this.state,n)},n}(U);function M(t){var n=function(t){n.current=t};return n.current=t,n}function D(t,n,e,r){var o,i;return(null===(o=null==t?void 0:t.prototype)||void 0===o?void 0:o.render)?i=new t(n,e):((i=new U(n,e)).constructor=t,t._fr?(r.fr=M(),i.render=function(){return this.constructor(this.props,r.fr)}):i.render=C),i.$_p=r,i}var L=function(t){function n(n,e,r,o,i,u,c){void 0===c&&(c={});var f=t.call(this,n,e,r,o,i,u,g(c,n.defaultProps))||this;return f.typ="comp",f._usefs=[],f._uefs=[],f._defs=[],f}return l(n,t),n.prototype.s=function(t,n){var e=this.b;return!1!==e.shouldComponentUpdate(g(t,this.t.defaultProps),n||e.state)},n.prototype.r=function(t,n,e){var r,o,i=this,u=i.t;i.ps=g(i.ps,i.t.defaultProps);var c=i.ps,f=!i.b,s=u.contextType,a=i.b,p=null==s?void 0:s.get(i);i._cs=n,f?(a=D(u,c,p,i),i.b=a):(a.props=c,a.context=p);var d=a.state;i._usefs=[],i._uefs=[];var l=a.render();0===(null===(o=null===(r=null==l?void 0:l.props)||void 0===r?void 0:r.children)||void 0===o?void 0:o.length)&&(l.props.children=i.ps.children);var h=v(v({},n),a.$_cs);X(i,i._ps,l?[l]:[],t,h),f?i._uefs.push((function(){null==s||s.register(i),a.componentDidMount()})):i._uefs.push((function(){a.componentDidUpdate(e,d)})),t.push((function(){i._usefs.forEach((function(t){t()})),f?i.md():i.ud(),i._defs=i._uefs.map((function(t){return t()}))}))},n.prototype.ss=function(t){var n=this.b;n&&t&&(n.state=t)},n.prototype.un=function(){var t,n=this;n._ps.forEach((function(t){t.un()})),null===(t=n.t.contextType)||void 0===t||t.unregister(n),clearTimeout(n.b.$_timer),n._defs.forEach((function(t){t&&t()})),n.b.componentWillUnmount()},n}(T),R=function(){function t(){this.keys=[],this.values=[]}var n=t.prototype;return n.get=function(t){return this.values[this.keys.indexOf(t)]},n.set=function(t,n){var e=this.keys,r=this.values,o=e.indexOf(t),i=-1===o?e.length:o;e[i]=t,r[i]=n},t}(),I=function(){function t(){this.object={}}var n=t.prototype;return n.get=function(t){return this.object[t]},n.set=function(t,n){this.object[t]=n},t}(),B="function"==typeof Map,W=function(){function t(){}var n=t.prototype;return n.connect=function(t,n){this.prev=t,this.next=n,t&&(t.next=this),n&&(n.prev=this)},n.disconnect=function(){var t=this.prev,n=this.next;t&&(t.next=n),n&&(n.prev=t)},n.getIndex=function(){for(var t=this,n=-1;t;)t=t.prev,++n;return n},t}();var q=function(){function t(t,n,e,r,o,i,u,c){this.prevList=t,this.list=n,this.added=e,this.removed=r,this.changed=o,this.maintained=i,this.changedBeforeAdded=u,this.fixed=c}var n=t.prototype;return Object.defineProperty(n,"ordered",{get:function(){return this.cacheOrdered||this.caculateOrdered(),this.cacheOrdered},enumerable:!0,configurable:!0}),Object.defineProperty(n,"pureChanged",{get:function(){return this.cachePureChanged||this.caculateOrdered(),this.cachePureChanged},enumerable:!0,configurable:!0}),n.caculateOrdered=function(){var t=function(t,n){var e=[],r=[];return t.forEach((function(t){var n=t[0],o=t[1],i=new W;e[n]=i,r[o]=i})),e.forEach((function(t,n){t.connect(e[n-1])})),t.filter((function(t,e){return!n[e]})).map((function(t,n){var o=t[0],i=t[1];if(o===i)return[0,0];var u=e[o],c=r[i-1],f=u.getIndex();return u.disconnect(),c?u.connect(c,c.next):u.connect(void 0,e[0]),[f,u.getIndex()]}))}(this.changedBeforeAdded,this.fixed),n=this.changed,e=[];this.cacheOrdered=t.filter((function(t,r){var o=t[0],i=t[1],u=n[r],c=u[0],f=u[1];if(o!==i)return e.push([c,f]),!0})),this.cachePureChanged=e},t}();function z(t,n,e){var r=B?Map:e?I:R,o=e||function(t){return t},i=[],u=[],c=[],f=t.map(o),s=n.map(o),a=new r,p=new r,d=[],l=[],v={},h=[],_=0,y=0;return f.forEach((function(t,n){a.set(t,n)})),s.forEach((function(t,n){p.set(t,n)})),f.forEach((function(t,n){var e=p.get(t);void 0===e?(++y,u.push(n)):v[e]=y})),s.forEach((function(t,n){var e=a.get(t);void 0===e?(i.push(n),++_):(c.push([e,n]),y=v[n]||0,d.push([e-y,n-_]),l.push(n===e),e!==n&&h.push([e,n]))})),u.reverse(),new q(t,n,i,u,h,c,d,l)}function H(t,n){var e=s(t),r=s(n),o=z(e,r,(function(t){return t})),i={},u={},c={};return o.added.forEach((function(t){var e=r[t];i[e]=n[e]})),o.removed.forEach((function(n){var r=e[n];u[r]=t[r]})),o.maintained.forEach((function(r){var o=r[0],i=e[o],u=[t[i],n[i]];t[i]!==n[i]&&(c[i]=u)})),{added:i,removed:u,changed:c}}var G=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.typ="elem",n._es={},n._svg=!1,n}return l(n,t),n.prototype.e=function(t,n){var e,r,o,i,u=this,c=u._es,f=u.b,s=function(t){return t.replace(/^on/g,"").toLowerCase()}(t);n?(p(f,s,c[t]),delete c[t]):(c[t]=function(n){var e,r;null===(r=(e=u.ps)[t])||void 0===r||r.call(e,n)},e=f,r=s,o=c[t],e.addEventListener(r,o,i))},n.prototype.s=function(t){return b(this.ps,t)},n.prototype.r=function(t,n,e){var r,o=this,i=!o.b,u=o.ps;if(i){var c=!1;if(o._svg||"svg"===o.t)c=!0;else{var s=O(o.c);c=s&&s.ownerSVGElement}o._svg=c;var a=u.portalContainer;if(!a){a=null===(r=o._hyd)||void 0===r?void 0:r.splice(0,1)[0];var p=o.t;a?o._hyd=[].slice.call(a.children):a=c?document.createElementNS("http://www.w3.org/2000/svg",p):document.createElement(p)}o.b=a}X(o,o._ps,u.children,t,n);var d=o.b,l=x(e),v=l[0],h=l[1],_=x(u),y=_[0],m=_[1];return function(t,n,e){var r=H($(t),$(n)),o=r.added,i=r.removed,u=r.changed;for(var c in o)e.setAttribute(c,o[c]);for(var f in u)e.setAttribute(f,u[f][1]);for(var s in i)e.removeAttribute(s)}(v,y,d),function(t,n,e){var r=H(t,n),o=r.added,i=r.removed;for(var u in i)e.e(u,!0);for(var c in o)e.e(c)}(h,m,o),function(t,n,e){var r=e.style,o=H(t,n),i=o.added,u=o.removed,c=o.changed;for(var s in i){var a=f(s,"-");r.setProperty(a,i[s])}for(var s in c){var p=f(s,"-");r.setProperty(p,c[s][1])}for(var s in u){var d=f(s,"-");r.removeProperty(d)}}(e.style||{},u.style||{},d),t.push((function(){i?o.md():o.ud()})),!0},n.prototype.un=function(){var t=this,n=t._es,e=t.b;for(var r in n)p(e,r,n[r]);t._ps.forEach((function(t){t.un()})),t._es={},t.ps.portalContainer||t._sel||(console.log(e),E(e))},n}(T);function V(t){if(!t||t instanceof Node)return t;var n=t.$_p._ps;return n.length?V(n[0].b):null}function Z(t){if(t){if(t.b&&t.b instanceof Node)return t;var n=t._ps;return n.length?Z(n[0]):null}}function F(t,n){for(var e=[],r=2;r<arguments.length;r++)e[r-2]=arguments[r];var o,i=n||{},u=i.key,c=i.ref,f=h(i,["key","ref"]);return{type:t,key:u,ref:c,props:v(v({},f),{children:(o=e,o.reduce((function(t,n){return t.concat(n)}),[])).filter((function(t){return null!=t&&!1!==t}))})}}var J=function(t){function n(n,e){void 0===e&&(e=0);var r=t.call(this,"container",e,"container",0,null)||this;return r.typ="container",r.b=n,r}return l(n,t),n.prototype.r=function(){return!0},n.prototype.un=function(){},n}(T),K=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.typ="text",n}return l(n,t),n.prototype.r=function(t){var n,e=this,r=!e.b;if(r){var o=null===(n=e._hyd)||void 0===n?void 0:n.splice(0,1)[0];e.b=o||document.createTextNode(e.t.replace("text_",""))}return t.push((function(){r?e.md():e.ud()})),!0},n.prototype.un=function(){E(this.b)},n}(T);function Q(t,n,e,r){var o=r.d+1;if(i(t)||u(t))return new K("text_".concat(t),o,n,e,r,null,{});var c=t.type;return new("string"==typeof c?G:L)(c,o,n,e,r,t.ref,t.props)}function X(t,n,e,r,o,u,c){var f=function(t,n,e){var r=e.map((function(t){return i(t)?null:t.key})),o=z(y(n.map((function(t){return t.k}))),y(r),(function(t){return t}));o.removed.forEach((function(t){n.splice(t,1)[0].un()})),o.ordered.forEach((function(t){var e=t[0],r=t[1],o=n.splice(e,1)[0];n.splice(r,0,o);var i=V(o.b),u=V(n[r+1]&&n[r+1].b);i&&i.parentNode.insertBefore(i,u)})),o.added.forEach((function(o){n.splice(o,0,Q(e[o],r[o],o,t))}));var u=o.maintained.filter((function(o){o[0];var u=o[1],c=e[u],f=n[u];return(i(c)?"text_".concat(c):c.type)!==f.t?(f.un(),n.splice(u,1,Q(c,r[u],u,t)),!0):(f.i=u,!1)}));return _(_([],o.added,!0),u.map((function(t){return t[0],t[1]})),!0)}(t,n,e),s=t._hyd,a=n.filter((function(t,n){return t._hyd=s,t.u(r,o,e[n],u,c)}));"container"===t.typ&&t._sel&&n.forEach((function(t){var n=Z(t);n&&(n._sel=!0)})),t._hyd=null;var p=O(t);return p&&f.reverse().forEach((function(e){var r=n[e],o=V(r.b);if(o&&p!==o&&!o.parentNode){var i=function(t,n){for(var e=t._ps,r=e.length,o=n.i+1;o<r;++o){var i=V(e[o].b);if(i)return i}return null}(t,r);p.insertBefore(o,i)}})),a.length>0}function Y(t,n,e,r){void 0===e&&(e=n.__CROACT__),void 0===r&&(r={});var o=!!e;e||(e=new J(n));var i=[];return X(e,e._ps,t?[t]:[],i,r,void 0,void 0),w(i),N(null),o||(n.__CROACT__=e),e}var tt=0;var nt=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return l(n,t),n.prototype.componentDidMount=function(){var t=this,n=t.props,e=n.element,r=n.container,o=t.$_p;t._pp=new J(r,o.d+1),Y(e,r,t._pp,o._cs)},n.prototype.componentDidUpdate=function(){var t=this,n=t.props;Y(n.element,n.container,t._pp,t.$_p._cs)},n.prototype.componentWillUnmount=function(){var t=this;Y(null,t.props.container,t._pp,t.$_p._cs),this._pp=null},n}(k);function et(t,n,e){if(null==t)return"";if(i(t)||u(t)||c(t))return t;var r=t.type,o=t.props;if(i(r)){var s={};a(o).forEach((function(t){var n=t[0],e=t[1];if("style"===n)s[n]=a(e).map((function(t){var n=t[0],e=t[1];return"".concat(f(n),": ").concat(e,";")})).join("");else{if("children"===n)return;n.match(/^on[^a-z]/g)||(s[n]="".concat(e))}}));var p=o.children.map((function(t){return et(t,n)})).join("");if(e)return{tagName:r,props:s,children:p};var d=_([r],a(s).map((function(t){var n=t[0],e=t[1];return"".concat(n,'="').concat(e.replace(/"/g,'\\"'),'"')})),!0);return"<".concat(d.join(" "),">").concat(p,"</").concat(r,">")}if(c(r)){var l=r.contextType,h={b:null,_hs:[],_usefs:[],_uefs:[],_defs:[],_cs:n};N(h);var y=D(r,o,null==l?void 0:l.get(h),{}),m=v(v({},n),y.$_cs);return h.b=y,et(y.render(),m,e)}return""}function rt(t){var n=S(),e=n._hs||(n._hs=[]),r=A(),o=e[r];if(P=r+1,o){if(!b(o.deps,t.deps))return o.updated=!1,o;e[r]=t}else e.push(t);return t.value=t.func(),t.updated=!0,t}function ot(t,n){return rt({func:t,deps:n}).value}function it(t,n,e){var r=S(),o=rt({func:function(){return t},deps:n}),i=e?r._usefs:r._uefs;o.updated?i.push((function(){return o.effect&&o.effect(),o.effect=t(),o.effect})):i.push((function(){return o.effect}))}t.Component=U,t.ContainerProvider=J,t.PureComponent=k,t.createContext=function(t){var n="c".concat(++tt);function e(t,n){return t.children(n)}function r(t){return t._cs[n]}var o={$_id:n,$_dv:t,Consumer:e,Provider:function(t){var e=this;if(!e.$_cs[n]){e.$_cs[n]=e;e.shouldComponentUpdate=function(t){t.value!==e.props.value&&(e.$_req=!0)},e.render=function(){return e.props.children[0]},e.$_subs=[]}return t.children[0]},get:function(n){var e,o;return null!==(o=null===(e=r(n))||void 0===e?void 0:e.props.value)&&void 0!==o?o:t},register:function(t){var n,e,o=r(t);o&&(n=o.$_subs,e=t,-1===n.indexOf(e)&&n.push(e))},unregister:function(t){var n=r(t);if(n){var e=n.$_subs,o=e.indexOf(t);o>-1&&e.splice(o,1)}}};return e.contextType=o,o},t.createElement=F,t.createPortal=function(t,n){return F(nt,{element:t,container:n})},t.createRef=M,t.findDOMNode=V,t.findNodeProvider=Z,t.forwardRef=function(t){return t._fr=!0,t},t.render=function(t,n,e){var r=n.__CROACT__;t&&!r&&(n.innerHTML=""),Y(t,n,r),e&&e()},t.renderSelf=function(t,n,e){return!e&&t&&((e=new J(n.parentElement))._hyd=[n],e._sel=!0),Y(t,n,e),e},t.renderSelfToString=function(t){return et(t,{},!0)},t.renderToString=function(t){return et(t,{})},t.useContext=function(t){var n=S(),e=t.$_id,r=n._cs;return e in r?r[e].props.value:t.$_dv,it((function(){return t.register(n),function(){t.unregister(n)}}),[]),t.get(n)},t.useEffect=it,t.useImperativeHandle=function(t,n,e){it((function(){null==t||t(n())}),e,!0)},t.useMemo=ot,t.useRef=function(t){return ot((function(){return M(t)}),[])},t.useState=function(t){var n=S(),e=A(),r=n.b;return rt({func:function(){r.state[e]=c(t)?t():t},deps:[]}),[r.state[e],function(t){var n;return r.setState(((n={})[e]=t,n))}]},t.version="simple-1.0.0"}));
//# sourceMappingURL=croact.min.js.map
